# CNN

This repository contians parallel implementations of a bespoke convolutional neural network leveraging both PyTorch and MLX. 

An example run here, which trains a new pytorch-based model on the MNIST dataset, and then tests its accuracy after 10 epochs:
```
  time python3 main.py --mnist ./mnist --epochs 10 --device cpu --batch 512 --lr 0.0001 --framework pytorch --bench
  100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 106/106 [00:39<00:00,  2.70it/s]
  training epoch 1 avg loss: 1.2513219118118286 accuracy: 58.600%
  100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.01it/s]
  validation epoch 1 accuracy: 94.450%
  100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 106/106 [00:41<00:00,  2.58it/s]
  training epoch 2 avg loss: 0.6105284094810486 accuracy: 74.467%
  100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.44it/s]
  validation epoch 2 accuracy: 96.750%
  100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 106/106 [00:39<00:00,  2.69it/s]
  training epoch 3 avg loss: 0.5223381519317627 accuracy: 76.313%
  100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.92it/s]
  validation epoch 3 accuracy: 97.400%
  [...]
  testing ...
  100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:04<00:00, 2157.41it/s]
  Final test dataset accuracy: 99.080%
```
